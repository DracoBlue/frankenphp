name: Setup PHP
description: Setup PHP for Darwin
inputs:
  version:
    description: PHP Version
    required: true
  configurationParameters:
    default: ''
    description: Additional flags for ./configure
    required: false
runs:
  using: composite
  steps:
    - name: Checkout PHP Source
      uses: ./.github/actions/php/checkout
      with:
        version: ${{ inputs.version }}

    - name: Setup Cache
      id: cache
      uses: ./.github/actions/php/cache
      with:
        os: darwin
        additionalKey: ${{ hashFiles('./.github/actions/php/darwin/configure/action.yml', './.github/actions/php/darwin/install/action.yml') }}

    - name: Install Packages
      uses: ./.github/actions/php/darwin/brew

    - name: Configure PHP
      if: steps.cache.outputs.cache-hit != 'true'
      uses: ./.github/actions/php/darwin/configure
      with:
        configurationParameters: ${{ inputs.configurationParameters }}

    - name: Install PHP
      uses: ./.github/actions/php/darwin/install
